<!DOCTYPE html>
<html>
<head>
  <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.js"></script>
</head>

<body style="margin:0; overflow:hidden;">

<a-scene embedded arjs>

  <!-- Marker -->
  <a-marker preset="hiro" id="marker">

    <!-- Animated Object -->
    <a-box id="box"
      position="0 0.5 0"
      scale="0 0 0"
      color="red">

      <!-- Continuous rotation -->
      <a-animation attribute="rotation"
                   to="0 360 0"
                   dur="3000"
                   repeat="indefinite"
                   easing="linear">
      </a-animation>

    </a-box>

  </a-marker>

  <a-entity camera></a-entity>

</a-scene>

<script>
const marker = document.querySelector("#marker");
const box = document.querySelector("#box");


// MARKER FOUND → Appear + bounce + color change
marker.addEventListener("markerFound", () => {

  // Pop in
  box.setAttribute("animation__scale", {
    property: "scale",
    to: "1 1 1",
    dur: 500,
    easing: "easeOutElastic"
  });

  // Bounce
  box.setAttribute("animation__bounce", {
    property: "position",
    dir: "alternate",
    dur: 700,
    loop: true,
    to: "0 1 0"
  });

  // Random color every second
  box.colorInterval = setInterval(() => {
    const randomColor = "#" + Math.floor(Math.random()*16777215).toString(16);
    box.setAttribute("color", randomColor);
  }, 1000);

});


// MARKER LOST → Disappear
marker.addEventListener("markerLost", () => {

  box.setAttribute("animation__scale", {
    property: "scale",
    to: "0 0 0",
    dur: 300,
    easing: "easeInBack"
  });

  clearInterval(box.colorInterval);
});


// CLICK / TAP → Explosion reaction
box.addEventListener("click", () => {

  // Jump
  box.setAttribute("animation__jump", {
    property: "position",
    to: "0 2 0",
    dur: 300,
    dir: "alternate",
    easing: "easeOutQuad"
  });

  // Spin fast
  box.setAttribute("animation__spin", {
    property: "rotation",
    to: "0 1080 0",
    dur: 800,
    easing: "easeOutCubic"
  });

});
</script>

</body>
</html>

